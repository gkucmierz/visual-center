{"version":3,"sources":["assets/demo.js","visualCenter.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","_","require","base64ImageToRGBMatrix","base64ImageUtils","COLOR_DIFF_WEIGHT_EXPO","ROUNDS","SIZE","recursiveGetCoord","rgbMatrix","visualLeft","visualTop","currentAxis","stepSize","bgColor","normalizeColor","height","length","width","visualLeftToApply","visualTopToApply","ops","maxDiff","Math","max","r","g","b","maxDistance","getDistance","newVisualLeft","newVisualTop","oldCenterIntensity","getCenterIntensity","newCenterIntensity","centerPoint","reduce","resRow","row","rowIdx","resCol","col","colIdx","cellColorDiff","baseColor","testColor","a","diff","abs","pow","rgbDiff","cellDistance","pointA","pointB","color","floor","visualCenter","base64","callback","opts","oldLeft","oldTop","successCenterIntents","centerIntents","err","calculateVisualCenter","size","toPercent","number","round","App","props","state","showGuides","useCircle","useSpin","backgroundColor","this","setState","demoImage","fileArray","file","reader","FileReader","addEventListener","data","processBase64","currentTarget","result","readAsDataURL","centerIntensity","resultLeft","resultTop","nColor","bgColorCode","bgColorCodeDark","isDark","recommendations","compact","className","style","onDrop","bind","src","transform","Array","fill","map","el","elIdx","arr","tot","opacity","shadowStyle","transformOrigin","normalStyle","key","type","checked","onChange","rec","recIdx","href","target","React","Component","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.2a819b3b.chunk.js","sourcesContent":["module.exports = \"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgICB3aWR0aD0iMjhweCIgaGVpZ2h0PSIyOCIgdmlld0JveD0iMCAwIDUwIDQ0LjE1NSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTAgNDQuMTU1IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBmaWxsPSIjNEQ5OUNCIiBkPSJNMzIuNTU5LDIxLjMyNmMwLjEyNS0wLjE0MSwwLjE3OC0wLjMyNywwLjE0Ni0wLjUxbC0zLjE4LTE5LjE5MmMtMC4wNDMtMC4yNjQtMC4yNTItMC40NzItMC41MTYtMC41MTMgIGMtMS4zMzYtMC4yMTYtMi42OTEtMC4zMjctNC4wMzMtMC4zMjdjLTEuMjA0LDAtMi40MTEsMC4wODYtMy41OTUsMC4yNmMtMC4yNjEsMC4wNDMtMC40NzEsMC4yNDQtMC41MiwwLjUwM2wtMy41NjQsMTkuMTczICBjLTAuMDUxLDAuMjgxLDAuMDk2LDAuNTY0LDAuMzU5LDAuNjgxYzAuMTQ4LDAuMDY3LDMuNzA2LDEuNjIsOC4wMjcsMS42MmMyLjQ1MiwwLDQuNjU5LTAuNTA2LDYuNTYzLTEuNTA1ICBDMzIuMzY3LDIxLjQ4NiwzMi40NzcsMjEuNDE3LDMyLjU1OSwyMS4zMjYiLz48cGF0aCBmaWxsPSIjNEQ5OUNCIiBkPSJNNDkuNTE0LDM2LjE4OGwtMTQuODItMTIuNjdjLTAuMTE1LTAuMS0wLjI1OC0wLjE0OS0wLjQtMC4xNDljLTAuMTMxLDAtMC4yNiwwLjAzNS0wLjM2NywwLjEyMSAgYy0wLjI5MSwwLjIxLTcuMTAyLDUuMjU1LTcuMzk2LDEyLjU3OGMtMC4wMzEsMC4xMTctMC4wMjksMC4yNDIsMC4wMDgsMC4zNTljMC4wNjEsMC4xNzgsMC4xOTUsMC4zMiwwLjM3MywwLjM4NWwxOC4yMTEsNi44NDIgIGMwLjA2OCwwLjAyNywwLjE0NiwwLjAzOSwwLjIyMSwwLjAzOWMwLjE4LDAsMC4zNTctMC4wODIsMC40NzUtMC4yMjljMS42MzctMi4wMDIsMi45NDEtNC4yMTMsMy44NzEtNi41NzQgIEM0OS43ODksMzYuNjQzLDQ5LjcxNSwzNi4zNjEsNDkuNTE0LDM2LjE4OCIvPjxwYXRoIGZpbGw9IiM0RDk5Q0IiIGQ9Ik0xNi4wNzUsMjMuNDg5Yy0wLjEwOC0wLjA4Mi0wLjIzNS0wLjEyMy0wLjM2NS0wLjEyM2MtMC4xNDQsMC0wLjI4OCwwLjA1LTAuNDA0LDAuMTQ5TDAuNDg1LDM2LjE4OCAgYy0wLjIwMSwwLjE3NC0wLjI3MiwwLjQ1NS0wLjE3MywwLjcwMWMwLjkzMywyLjM2MSwyLjIzNSw0LjU3MiwzLjg3LDYuNTc0YzAuMTIsMC4xNDYsMC4yOTksMC4yMjksMC40ODEsMC4yMjkgIGMwLjA3MywwLDAuMTQ2LTAuMDA4LDAuMjE5LTAuMDM5bDE4LjIxLTYuODQyYzAuMTc3LTAuMDY0LDAuMzEzLTAuMjA3LDAuMzcyLTAuMzg1YzAuMDQtMC4xMTcsMC4wNDItMC4yNDIsMC4wMDktMC4zNTkgIEMyMy4xNzYsMjguNzQ0LDE2LjM2OCwyMy42OTcsMTYuMDc1LDIzLjQ4OSIvPjwvc3ZnPgo=\"","import base64ImageUtils from \"base64-image-utils\";\n\nconst _ = require(\"lodash\");\nconst { base64ImageToRGBMatrix } = base64ImageUtils;\n\nconst COLOR_DIFF_WEIGHT_EXPO = 0.333;\n\nconst ROUNDS = 200;\nconst SIZE = 420;\n\nfunction visualCenter(base64, callback, opts = {}) {\n  const { oldLeft = 0.5, oldTop = 0.5, successCenterIntents, centerIntents } = opts;\n\n  base64ImageToRGBMatrix(\n    base64,\n    (err, rgbMatrix) => {\n      const height = rgbMatrix.length;\n      const width = rgbMatrix[0].length;\n      const bgColor = normalizeColor(rgbMatrix[0][0]);\n\n      const { visualLeft, visualTop } = calculateVisualCenter(rgbMatrix);\n\n      callback(null, {\n        visualTop: visualTop,\n        visualLeft: visualLeft,\n\n        bgColor: bgColor,\n        width: width,\n        height: height\n      });\n    },\n    {\n      size: SIZE\n    }\n  );\n}\n\nfunction calculateVisualCenter(rgbMatrix) {\n  var visualLeft = 0.5;\n  var visualTop = 0.5;\n\n  var { visualLeft } = recursiveGetCoord(rgbMatrix, visualLeft, visualTop, \"X\", 1 / ROUNDS);\n  var { visualLeft } = recursiveGetCoord(rgbMatrix, visualLeft, visualTop, \"X\", -1 / ROUNDS);\n  var { visualTop } = recursiveGetCoord(rgbMatrix, visualLeft, visualTop, \"Y\", 1 / ROUNDS);\n  var { visualTop } = recursiveGetCoord(rgbMatrix, visualLeft, visualTop, \"Y\", -1 / ROUNDS);\n\n  return { visualLeft, visualTop };\n}\n\nfunction recursiveGetCoord(rgbMatrix, visualLeft, visualTop, currentAxis, stepSize) {\n  const bgColor = normalizeColor(rgbMatrix[0][0]);\n  const height = rgbMatrix.length;\n  const width = rgbMatrix[0].length;\n\n  var visualLeftToApply = visualLeft;\n  var visualTopToApply = visualTop;\n\n  const ops = {\n    bgColor,\n    height: rgbMatrix.length,\n    width: rgbMatrix[0].length,\n    maxDiff:\n      Math.max(bgColor.r, 255 - bgColor.r) +\n      Math.max(bgColor.g, 255 - bgColor.g) +\n      Math.max(bgColor.b, 255 - bgColor.b),\n    maxDistance: getDistance([0, 0], [width, height])\n  };\n\n  var newVisualLeft = visualLeft;\n  var newVisualTop = visualTop;\n\n  if (currentAxis === \"X\") {\n    newVisualLeft += stepSize;\n  } else {\n    newVisualTop += stepSize;\n  }\n\n  var oldCenterIntensity = getCenterIntensity(rgbMatrix, visualLeft, visualTop, ops);\n  var newCenterIntensity = getCenterIntensity(rgbMatrix, newVisualLeft, newVisualTop, ops);\n\n  while (newCenterIntensity > oldCenterIntensity) {\n    visualLeftToApply = newVisualLeft;\n    visualTopToApply = newVisualTop;\n\n    if (currentAxis === \"X\") {\n      newVisualLeft += stepSize;\n    } else {\n      newVisualTop += stepSize;\n    }\n    oldCenterIntensity = newCenterIntensity;\n    newCenterIntensity = getCenterIntensity(rgbMatrix, newVisualLeft, newVisualTop, ops);\n  }\n\n  return {\n    visualLeft: visualLeftToApply,\n    visualTop: visualTopToApply\n  };\n}\n\nfunction getCenterIntensity(rgbMatrix, visualLeft, visualTop, ops) {\n  const { bgColor, height, width, maxDiff, maxDistance } = ops;\n\n  const centerCol = visualTop * height;\n  const centerRow = visualLeft * width;\n  const centerPoint = [centerCol, centerRow];\n\n  return _.reduce(\n    rgbMatrix,\n    (resRow, row, rowIdx) => {\n      return (\n        resRow +\n        _.reduce(\n          row,\n          (resCol, col, colIdx) => {\n            const cellColorDiff = rgbDiff(bgColor, col, maxDiff);\n\n            if (!cellColorDiff) return resCol;\n\n            const cellDistance = getDistance(centerPoint, [rowIdx, colIdx]);\n            const cellColorWeight = cellColorDiff * Math.pow(1 - cellDistance / maxDistance, 0.5) * 1000;\n\n            return resCol + cellColorWeight;\n          },\n          0\n        )\n      );\n    },\n    0\n  );\n}\n\nfunction getDistance(pointA, pointB) {\n  return Math.pow(Math.pow(pointA[0] - pointB[0], 2) + Math.pow(pointA[1] - pointB[1], 2), 0.5);\n}\n\nfunction normalizeColor(color) {\n  return {\n    r: Math.floor(color.r * (color.a / 255) + 255 * (1 - color.a / 255)),\n    g: Math.floor(color.g * (color.a / 255) + 255 * (1 - color.a / 255)),\n    b: Math.floor(color.b * (color.a / 255) + 255 * (1 - color.a / 255)),\n    a: 255\n  };\n}\n\nfunction rgbDiff(baseColor, testColor, maxDiff) {\n  if (testColor.a === 0) return 0;\n\n  const diff =\n    Math.abs(baseColor.r - testColor.r) + Math.abs(baseColor.g - testColor.g) + Math.abs(baseColor.b - testColor.b);\n  const result = Math.pow(diff / maxDiff, COLOR_DIFF_WEIGHT_EXPO) * (testColor.a / 255) * 1000;\n\n  return result;\n}\n\n// module.exports = visualCenter;\nexport default visualCenter;\n","import React from \"react\";\n\nimport Dropzone from \"react-dropzone\";\nimport _ from \"lodash\";\n\nimport visualCenter from \"./visualCenter.js\";\nimport demoImage from \"./assets/demo.js\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super();\n\n    this.state = {\n      base64: null,\n\n      showGuides: true,\n      useCircle: true,\n      useSpin: false,\n\n      visualLeft: 0.5,\n      visualTop: 0.605,\n\n      backgroundColor: {\n        r: 255,\n        g: 255,\n        b: 255,\n        a: 255\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      base64: demoImage\n    });\n    // this.processBase64(demoImage);\n  }\n\n  onDrop(fileArray) {\n    var file = fileArray[0];\n    var reader = new FileReader();\n\n    reader.addEventListener(\n      \"load\",\n      data => {\n        this.processBase64(data.currentTarget.result);\n      },\n      false\n    );\n\n    if (file) {\n      reader.readAsDataURL(file);\n    }\n  }\n\n  processBase64(base64) {\n    visualCenter(base64, (err, result) => {\n      var { visualTop, visualLeft, bgColor, centerIntensity } = result;\n\n      this.setState({\n        visualTop: visualTop,\n        visualLeft: visualLeft,\n\n        base64: base64,\n        backgroundColor: bgColor\n      });\n    });\n  }\n\n  render() {\n    const { base64, visualTop, visualLeft, showGuides, useCircle, useSpin, backgroundColor } = this.state;\n    const resultLeft = visualLeft;\n    const resultTop = visualTop;\n\n    const nColor = normalizeColor(backgroundColor);\n\n    const bgColorCode = `rgb(${nColor.r}, ${nColor.g}, ${nColor.b})`;\n    const bgColorCodeDark = `rgb(${Math.floor(nColor.r * 0.9)}, ${Math.floor(nColor.g * 0.9)}, ${Math.floor(\n      nColor.b * 0.9\n    )})`;\n    const isDark = nColor.r + nColor.g + nColor.b < (255 * 3) / 1.7;\n\n    const recommendations = _.compact([\n      resultLeft > 0.5 && (\n        <span>\n          move it left by <b>{toPercent(resultLeft - 0.5)}%</b>\n        </span>\n      ),\n      resultLeft < 0.5 && (\n        <span>\n          move it right by <b>{toPercent(1 - resultLeft - 0.5)}%</b>\n        </span>\n      ),\n      resultLeft !== 0.5 && resultTop !== 0.5 && <span> and </span>,\n      resultTop > 0.5 && (\n        <span>\n          move it up by <b>{toPercent(resultTop - 0.5)}%</b>\n        </span>\n      ),\n      resultTop < 0.5 && (\n        <span>\n          move it down by <b>{toPercent(1 - resultTop - 0.5)}%</b>\n        </span>\n      )\n    ]);\n\n    return (\n      <div className=\"app\" style={{ backgroundColor: bgColorCodeDark, color: isDark ? \"#fff\" : \"#333\" }}>\n        <div className=\"app-header\">\n          <h1 className=\"app-title\">Visual Center</h1>\n          <div>Find the visual center of your images.</div>\n\n          <Dropzone onDrop={this.onDrop.bind(this)} className=\"dropzone\">\n            <div>Start by selecting your image. Click or drop here.</div>\n          </Dropzone>\n        </div>\n\n        <div\n          className={`demo-image-comparison ${showGuides ? \"-show-guides\" : \"\"} ${useCircle ? \"-use-circle\" : \"\"} ${\n            useSpin ? \"-use-spin\" : \"\"\n          }`}>\n          <div className=\"column\">\n            <div className=\"demo-image-container-title\">Container Center</div>\n            <div className=\"demo-image-container\" style={{ backgroundColor: bgColorCode }}>\n              <img\n                src={base64}\n                style={{\n                  transform: `translatey(-50%) translatex(-50%)`\n                }}\n                className=\"demo-image\"\n              />\n\n              {new Array(32).fill(\"\").map((el, elIdx, arr) => {\n                const tot = arr.length * 3;\n\n                const opacity = 0 + 0.2 * ((arr.length - elIdx) / arr.length);\n\n                const shadowStyle = {\n                  transform: `translatey(-${0.5 * 100}%) translatex(${-0.5 * 100}%) rotate(-${(360 / tot) * elIdx}deg)`,\n                  opacity: opacity,\n                  transformOrigin: `${0.5 * 100}% ${0.5 * 100}%`\n                };\n\n                const normalStyle = {\n                  transform: `translatey(-${0.5 * 100}%) translatex(${-0.5 * 100}%) rotate(0deg)`,\n                  opacity: 0,\n                  transformOrigin: `${0.5 * 100}% ${0.5 * 100}%`\n                };\n\n                return (\n                  <img\n                    src={base64}\n                    key={elIdx}\n                    className={`demo-image -shadow-${elIdx}`}\n                    style={useSpin ? shadowStyle : normalStyle}\n                  />\n                );\n              })}\n            </div>\n          </div>\n\n          <div className=\"column\">\n            <div className=\"demo-image-container-title\">Visual Center</div>\n            <div className=\"demo-image-container\" style={{ backgroundColor: bgColorCode }}>\n              <img\n                src={base64}\n                className=\"demo-image\"\n                style={{\n                  transform: `translatey(-${resultTop * 100}%) translatex(${-resultLeft * 100}%)`\n                }}\n              />\n\n              {new Array(32).fill(\"\").map((el, elIdx, arr) => {\n                const tot = arr.length * 3;\n\n                const opacity = 0 + 0.2 * ((arr.length - elIdx) / arr.length);\n\n                const shadowStyle = {\n                  transform: `translatey(-${resultTop * 100}%) translatex(${-resultLeft * 100}%) rotate(-${(360 / tot) *\n                    elIdx}deg)`,\n                  opacity: opacity,\n                  transformOrigin: `${resultLeft * 100}% ${resultTop * 100}%`\n                };\n\n                const normalStyle = {\n                  transform: `translatey(-${resultTop * 100}%) translatex(${-resultLeft * 100}%) rotate(0deg)`,\n                  opacity: 0,\n                  transformOrigin: `${resultLeft * 100}% ${resultTop * 100}%`\n                };\n\n                return (\n                  <img\n                    src={base64}\n                    key={elIdx}\n                    className={`demo-image -shadow-${elIdx}`}\n                    style={useSpin ? shadowStyle : normalStyle}\n                  />\n                );\n              })}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"app-control-container\">\n          <label className=\"app-control\">\n            <input\n              type=\"checkbox\"\n              checked={showGuides}\n              onChange={() => {\n                this.setState({ showGuides: !showGuides });\n              }}\n            />\n            <div>Show guides</div>\n          </label>\n\n          <label className=\"app-control\">\n            <input\n              type=\"checkbox\"\n              checked={useCircle}\n              onChange={() => {\n                this.setState({ useCircle: !useCircle });\n              }}\n            />\n            <div>Make the canvas a circle</div>\n          </label>\n\n          <label className=\"app-control\">\n            <input\n              type=\"checkbox\"\n              checked={useSpin}\n              onChange={() => {\n                this.setState({ useSpin: !useSpin });\n              }}\n            />\n            <div>Rotation Shadows</div>\n          </label>\n        </div>\n\n        {base64 && (\n          <div className=\"padding-2 results\">\n            <div>{base64 && `The center is at ${toPercent(resultLeft)}% - ${toPercent(resultTop)}%`}</div>\n            {recommendations.length ? (\n              <div>\n                {\"You can visual center your image if you \"}\n                {_.map(recommendations, (rec, recIdx) => {\n                  return <span key={recIdx}>{rec}</span>;\n                })}\n              </div>\n            ) : (\n              <div>Your image is perfectly centered! Congrats!</div>\n            )}\n            <div>\n              <br />\n              Interested in <strong>Sketch</strong> and <strong>Illustrator</strong> plugins?{\" \"}\n              <a href=\"http://eepurl.com/b5_E-j\" target=\"_blank\">\n                <strong>Join the newsletter!</strong>\n              </a>\n            </div>\n          </div>\n        )}\n\n        <div className=\"credits padding-2\">\n          <div>\n            More experiments:{\" \"}\n            <a href=\"http://javier.xyz/img2css\">\n              <b>img2css</b> (convert images to pure css)\n            </a>\n            ,{\" \"}\n            <a href=\"http://javier.xyz/cohesive-colors\">\n              <b>cohesive-colors</b> (creates cohesive color palletes)\n            </a>\n            ,{\" \"}\n            <a href=\"http://javier.xyz/morphin\">\n              <b>morphin</b> (css image morphing)\n            </a>\n            ,{\" \"}\n            <a href=\"http://javier.xyz/clashjs/\">\n              <b>clashjs</b> (js ai battle game)\n            </a>\n            .\n          </div>\n          <br />\n          <div>\n            Created by{\" \"}\n            <a href=\"http://javier.xyz/\">\n              <b>javierbyte</b>\n            </a>\n            . (Thanks <a href=\"http://skycatch.com\">Skycatch</a> for letting me use our logo).\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction normalizeColor(color) {\n  return {\n    r: Math.floor(color.r * (color.a / 255) + 255 * (1 - color.a / 255)),\n    g: Math.floor(color.g * (color.a / 255) + 255 * (1 - color.a / 255)),\n    b: Math.floor(color.b * (color.a / 255) + 255 * (1 - color.a / 255)),\n    a: 255\n  };\n}\n\nfunction toPercent(number) {\n  return Math.round(number * 10000) / 100;\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}